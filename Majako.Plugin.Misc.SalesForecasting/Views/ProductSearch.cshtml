@using Nop.Web.Areas.Admin.Models.Catalog
@using Nop.Services.Common
@using Nop.Core
@using Nop.Web.Areas.Admin.Factories
@using Majako.Plugin.Misc.SalesForecasting.Models

@inject IGenericAttributeService genericAttributeService
@inject IWorkContext workContext

@model ForecastSearchModel

@{
  const string hideSearchBlockAttributeName = "ProductListPage.HideSearchBlock";
  var hideSearchBlock = await genericAttributeService.GetAttributeAsync<bool>(await workContext.GetCurrentCustomerAsync(),
  hideSearchBlockAttributeName);
}

<div class="card card-default card-search">
  <div class="card-body">
    <div class="row search-row @(!hideSearchBlock ? "opened" : "")" data-hideAttribute="@hideSearchBlockAttributeName">
      <div class="search-text">@T("Admin.Common.Search")</div>
      <div class="icon-search"><i class="far fa-search" aria-hidden="true"></i></div>
      <div class="icon-collapse"><i class="far fa-angle-down" aria-hidden="true"></i></div>
    </div>

    <div class="search-body @(hideSearchBlock ? "closed" : "")">
      <div class="row">
        <div class="col-md-5">
          <div class="form-group row">
            <div class="col-md-4">
              <nop-label asp-for="SearchProductName" />
            </div>
            <div class="col-md-8">
              <nop-editor asp-for="SearchProductName" />
            </div>
          </div>
          <div class="form-group row" @(Model.AvailableCategories.SelectionIsNotPossible() ?
            Html.Raw("style=\"display:none\"") : null)>
            <div class="col-md-4">
              <nop-label asp-for="SearchCategoryId" />
            </div>
            <div class="col-md-8">
              <nop-select asp-for="SearchCategoryId" asp-items="Model.AvailableCategories" />
            </div>
          </div>
          <div class="form-group row" @(Model.AvailableCategories.SelectionIsNotPossible() ?
            Html.Raw("style=\"display:none\"") : null)>
            <div class="col-md-4">
              <nop-label asp-for="SearchIncludeSubCategories" />
            </div>
            <div class="col-md-8">
              <nop-editor asp-for="SearchIncludeSubCategories" />
            </div>
          </div>
          <div class="form-group row" @(Model.AvailableManufacturers.SelectionIsNotPossible() ?
            Html.Raw("style=\"display:none\"") : null)>
            <div class="col-md-4">
              <nop-label asp-for="SearchManufacturerId" />
            </div>
            <div class="col-md-8">
              <nop-select asp-for="SearchManufacturerId" asp-items="Model.AvailableManufacturers" />
            </div>
          </div>
        </div>
        <div class="col-md-7">
          <div class="form-group row">
            <div class="col-md-4">
              <nop-label asp-for="SearchStoreId" />
            </div>
            <div class="col-md-8">
              <nop-select asp-for="SearchStoreId" asp-items="Model.AvailableStores" />
            </div>
          </div>
          <div class="form-group row">
            <div class="col-md-4">
              <nop-label asp-for="SearchProductTypeId" />
            </div>
            <div class="col-md-8">
              <nop-select asp-for="SearchProductTypeId" asp-items="Model.AvailableProductTypes" />
            </div>
          </div>
          <div class="form-group row">
            <div class="col-md-4">
              <nop-label asp-for="SearchPublishedId" />
            </div>
            <div class="col-md-8">
              <nop-select asp-for="SearchPublishedId" asp-items="Model.AvailablePublishedOptions" />
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
